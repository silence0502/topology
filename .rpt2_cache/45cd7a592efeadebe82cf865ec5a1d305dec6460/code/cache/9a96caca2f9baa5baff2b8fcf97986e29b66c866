{"code":"import _ from 'lodash';\r\nvar VIM = joint.shapes.basic.Generic.extend({\r\n    markup: '<g class=\"rotatable\"><rect class=\"body\"/><rect class=\"card\"/><rect class=\"alarm\"/><text class=\"label\"/><text class=\"type\"/></g>',\r\n    defaults: _.defaultsDeep({\r\n        type: 'VIM',\r\n        size: {\r\n            width: 120,\r\n            height: 60\r\n        },\r\n        attrs: {\r\n            '.': {\r\n                magnet: false\r\n            },\r\n            '.label': {\r\n                text: '',\r\n                'ref-x': .5,\r\n                'ref-y': .4,\r\n                'font-size': 14,\r\n                'text-anchor': 'middle',\r\n                fill: '#000'\r\n            },\r\n            '.type': {\r\n                text: '',\r\n                'ref-x': .05,\r\n                'ref-y': .7,\r\n                'font-size': 14,\r\n                'text-anchor': 'left',\r\n                fill: '#000'\r\n            },\r\n            '.alarm': {\r\n                refX: '100%',\r\n                refX2: -10,\r\n                refY: '100%',\r\n                refY2: -10,\r\n                width: 10,\r\n                height: 10,\r\n            },\r\n            '.body': {\r\n                'ref-width': '100%',\r\n                'ref-height': '100%',\r\n                stroke: '#00B388',\r\n                'stroke-width': 3\r\n            }\r\n        }\r\n    }, joint.shapes.basic.Generic.prototype.defaults),\r\n    initialize: function () {\r\n        joint.shapes.basic.Generic.prototype.initialize.apply(this, arguments);\r\n    }\r\n});\r\nvar Link = joint.dia.Link.extend({\r\n    defaults: _.defaultsDeep({\r\n        type: 'Link',\r\n        // router: { name: 'manhattan' },\r\n        // connector: { name: 'rounded' },\r\n        attrs: {\r\n            '.connection': { stroke: '#C6C9CA', 'stroke-width': 3 },\r\n            '.link-tools': { display: 'none' },\r\n            '.marker-arrowheads': { display: 'none' },\r\n        },\r\n        z: -1\r\n    }, joint.dia.Link.prototype.defaults),\r\n    initialize: function () {\r\n        joint.dia.Link.prototype.initialize.apply(this, arguments);\r\n    }\r\n});\r\nvar linkOption = function (opt) {\r\n    var option = {\r\n        attrs: {\r\n            '.connection': {\r\n                stroke: '#C6C9CA',\r\n                'stroke-dasharray': ''\r\n            },\r\n            '.marker-target': {\r\n                stroke: '#C6C9CA',\r\n                fill: '#C6C9CA',\r\n                d: 'M 10 0 L 0 5 L 10 10 z' //箭头样式\r\n            },\r\n        }\r\n    };\r\n    if (opt) {\r\n        option.state = opt.state;\r\n        option.source = {\r\n            id: opt.source\r\n        };\r\n        option.target = {\r\n            id: opt.target\r\n        };\r\n        switch (opt.state) {\r\n            case 0:\r\n                option.attrs['.connection'].stroke = '#C6C9CA';\r\n                option.attrs['.marker-target'].fill = '#C6C9CA';\r\n                option.attrs['.marker-target'].stroke = '#C6C9CA';\r\n                break;\r\n            case 1:\r\n                option.attrs['.connection'].stroke = '#D10002';\r\n                option.attrs['.marker-target'].fill = '#fff';\r\n                option.attrs['.connection']['stroke-dasharray'] = '5 2';\r\n                option.attrs['.marker-target'].stroke = '#D10002';\r\n                break;\r\n            case 2:\r\n                option.attrs['.connection'].stroke = '#FF9901';\r\n                option.attrs['.connection']['stroke-dasharray'] = '5 2';\r\n                option.attrs['.marker-target'].fill = '#FF9901';\r\n                option.attrs['.marker-target'].stroke = '#FF9901';\r\n                break;\r\n            case 3:\r\n                option.attrs['.connection'].stroke = '#DFB202';\r\n                option.attrs['.connection']['stroke-dasharray'] = '5 2';\r\n                option.attrs['.marker-target'].fill = '#DFB202';\r\n                option.attrs['.marker-target'].stroke = '#DFB202';\r\n                break;\r\n            case 4:\r\n                option.attrs['.connection'].stroke = '#00BFFF';\r\n                option.attrs['.connection']['stroke-dasharray'] = '5 2';\r\n                option.attrs['.marker-target'].fill = '#00BFFF';\r\n                option.attrs['.marker-target'].stroke = '#00BFFF';\r\n                break;\r\n            default:\r\n                option.attrs['.connection'].stroke = '#31d0c6';\r\n                option.attrs['.connection']['stroke-dasharray'] = '5 2';\r\n                option.attrs['.marker-target'].fill = '#31d0c6';\r\n                option.attrs['.marker-target'].stroke = '#31d0c6';\r\n                break;\r\n        }\r\n        switch (opt.type) {\r\n            case 0:\r\n                option.attrs['.marker-target'].d = 'M 10 0 L 0 5 L 10 10 z'; //三角箭头\r\n                break;\r\n            case 1:\r\n                option.attrs['.marker-target'].d = 'M 10 0 L 0 5 L 10 10 L 20 5 z'; //实心菱形\r\n                break;\r\n            case 2:\r\n                option.attrs['.marker-target'].d = 'M 10 0 L 0 5 L 10 10 L 20 5 z'; //空心菱形\r\n                option.attrs['.marker-target'].fill = '#fff';\r\n                break;\r\n            case 3:\r\n                option.attrs['.marker-target'].d = 'M 10 0 L 0 5 L 10 10 L 0 5 z'; //尖箭头\r\n                break;\r\n            case 4:\r\n                option.attrs['.marker-target'].d = ''; //没有箭头\r\n                break;\r\n            default:\r\n                option.attrs['.marker-target'].d = 'M 10 0 L 0 5 L 10 10 z';\r\n                break;\r\n        }\r\n    }\r\n    return option;\r\n};\r\nvar vimOption = function (opt) {\r\n    var option = { size: {}, attrs: { '.label': {}, '.type': {}, '.alarm': {}, '.body': {} } };\r\n    var dataTooltip = '';\r\n    var dataIcon = '';\r\n    if (opt) {\r\n        if (opt.id) {\r\n            option.id = opt.id;\r\n        }\r\n        if (opt.isHighlight) {\r\n            option.attrs['.body'].stroke = '#2AD2C9';\r\n        }\r\n        if (opt.bizFields) {\r\n            option.bizFields = opt.bizFields;\r\n        }\r\n        if (opt.label) {\r\n            dataTooltip = \"data-tooltip=\\\"\" + opt.label + \"\\\"\";\r\n            switch (opt.type) {\r\n                case 'switch':\r\n                    dataIcon = \"xlink:href=\" + opt.switch;\r\n                    break;\r\n                case 'vm':\r\n                    dataIcon = \"xlink:href=\" + opt.vm;\r\n                    break;\r\n                case 'vnf':\r\n                    dataIcon = \"xlink:href=\" + opt.vnf;\r\n                    break;\r\n                case 'vnfc':\r\n                    dataIcon = \"xlink:href=\" + opt.vnfc;\r\n                    break;\r\n                case 'server':\r\n                    dataIcon = \"xlink:href=\" + opt.server;\r\n                    break;\r\n                default:\r\n                    dataIcon = \"xlink:href=\" + opt.switch;\r\n                    break;\r\n            }\r\n            option.markup = \"<g class=\\\"rotatable\\\" \" + dataTooltip + \"><image \" + dataIcon + \" x=\\\"0\\\" y=\\\"0\\\" height=\\\"100px\\\" width=\\\"100px\\\"/> </g>\";\r\n        }\r\n        if (opt.type) {\r\n            option.attrs['.label'].text = opt.type;\r\n        }\r\n    }\r\n    return option;\r\n};\r\nexport { VIM, vimOption, Link, linkOption };\r\n//# sourceMappingURL=vim.js.map","map":{"version":3,"file":"vim.js","sourceRoot":"","sources":["../../src/module/view/vim.ts"],"names":[],"mappings":"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"},"dts":{"name":"F:/study/topology/module/view/vim.d.ts","text":"declare let VIM: any;\r\ndeclare let Link: any;\r\nexport interface IlinkOption {\r\n    state?: number;\r\n    source?: string;\r\n    target?: string;\r\n    type?: number;\r\n}\r\ndeclare let linkOption: (opt: IlinkOption) => any;\r\nexport interface IvimOption {\r\n    id?: string;\r\n    desc?: string;\r\n    label?: string;\r\n    state?: number;\r\n    type?: string;\r\n    bizFields?: any;\r\n    isHighlight?: boolean;\r\n    switch?: any;\r\n    vm?: any;\r\n    vnf?: any;\r\n    vnfc?: any;\r\n    server?: any;\r\n}\r\ndeclare let vimOption: (opt: IvimOption) => any;\r\nexport { VIM, vimOption, Link, linkOption };\r\n"}}
